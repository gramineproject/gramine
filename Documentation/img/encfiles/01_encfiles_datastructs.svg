<svg width="4084" height="1755" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><g transform="translate(-57 -173)"><rect x="61.5" y="476.5" width="686" height="166" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 105.235 578)">fd</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 165.964 591)">1</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 186.016 578)">=open(“</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 398.568 578)">file.enc</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 641.485 578)">”)</text><rect x="61.5" y="679.5" width="686" height="167" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 232.167 781)">fd</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 292.896 794)">2</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 312.949 781)">=dup(fd</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 525.501 794)">1</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 545.553 781)">)</text><rect x="861.5" y="609.5" width="686" height="167" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 905.54 712)">fd</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 966.269 725)">3</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 986.321 712)">=open(“</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 1198.87 712)">file.enc</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 1441.79 712)">”)</text><rect x="861.5" y="813.5" width="686" height="166" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 1032.15 915)">fd</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 1092.88 928)">4</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 1112.94 915)">=dup(fd</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 1325.49 928)">3</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 1345.54 915)">)</text><rect x="1671.5" y="476.5" width="623" height="166" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 1790.03 578)">libos_handle</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2154.41 591)">1</text><rect x="1956.5" y="770.5" width="829" height="166" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 2294.66 872)">inode</text><path d="M6.87511 34.375 6.87536 111.135-6.87464 111.135-6.87489 34.375ZM-20.6249 41.2501 0 0 20.6251 41.2499Z" transform="matrix(1 0 0 -1 2371 1047.14)"/><rect x="1956.5" y="1053.5" width="829" height="166" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 2066.92 1155)">libos_encrypted_file</text><rect x="2066.5" y="1486.5" width="829" height="166" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 2191.9 1566)">libos_encrypted_key</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2161.12 1629)">(128</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2235.03 1629)">-</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2247.06 1629)">bit AES</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2368.22 1629)">-</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2380.25 1629)">GCM root encryption key)</text><rect x="2066.5" y="1652.5" width="829" height="167" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 2328.56 1732)">pf_context</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2223.47 1795)">(in</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2264.14 1795)">-</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2276.17 1795)">enclave metadata &amp; buffers)</text><rect x="2066.5" y="1317.5" width="829" height="167" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 2328.55 1397)">pal_handle</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2256.94 1460)">(out</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2320.53 1460)">-</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2332.56 1460)">of</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2363.5 1460)">-</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2375.53 1460)">enclave file on host)</text><path d="M2030.98 1576.12 1982 1576.12C1978.2 1576.12 1975.13 1573.04 1975.13 1569.25L1975.13 1403 1988.88 1403 1988.88 1569.25 1982 1562.37 2030.98 1562.37ZM2024.11 1548.62 2065.36 1569.25 2024.11 1589.87Z"/><path d="M2030.98 1741.95 1982 1741.95C1978.2 1741.95 1975.13 1738.87 1975.13 1735.07L1975.13 1219 1988.88 1219 1988.88 1735.07 1982 1728.2 2030.98 1728.2ZM2024.11 1714.45 2065.36 1735.07 2024.11 1755.7Z"/><path d="M2030.98 1407.7 1982 1407.7C1978.2 1407.7 1975.12 1404.62 1975.12 1400.82L1975.12 1227 1988.88 1227 1988.88 1400.82 1982 1393.95 2030.98 1393.95ZM2024.11 1380.2 2065.36 1400.82 2024.11 1421.45Z"/><path d="M3361.06 1741.88 2945 1741.87 2945 1728.12 3361.06 1728.13ZM3354.18 1714.38 3395.43 1735 3354.18 1755.63Z"/><rect x="3395.5" y="989.5" width="741" height="125" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 3522.94 1070)">host_file_handle</text><rect x="3395.5" y="1114.5" width="741" height="124" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 3720.31 1195)">kdk</text><rect x="3395.5" y="1239.5" width="741" height="124" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 3507.76 1320)">mode = READ|WRITE</text><rect x="3395.5" y="1362.5" width="741" height="124" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 3568.49 1443)">metadata_node</text><rect x="3395.5" y="1486.5" width="741" height="125" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 3492.58 1568)">metadata_decrypted</text><rect x="3395.5" y="1611.5" width="741" height="124" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="none"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 3568.49 1692)">root_</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 3720.31 1692)">mht_node</text><rect x="2367.5" y="476.5" width="623" height="166" stroke="#000000" stroke-width="9.16667" stroke-linejoin="round" stroke-miterlimit="10" fill="#FFFFFF"/><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 2486.59 578)">libos_handle</text><text font-family="Consolas,Consolas_MSFontService,sans-serif" font-weight="400" font-size="37" transform="matrix(1 0 0 1 2850.96 591)">2</text><path d="M34.375-6.875 64.212-6.875C68.0089-6.875 71.087-3.79696 71.087 0L71.087 388.321 64.212 381.446 128.424 381.446 128.424 395.196 64.212 395.196C60.415 395.196 57.337 392.118 57.337 388.321L57.337 0 64.212 6.875 34.375 6.875ZM41.25 20.625 0 0 41.25-20.625Z" transform="matrix(-1.83697e-16 -1 -1 1.83697e-16 2370.32 770.424)"/><path d="M2364.12 736.049 2364.12 706.212C2364.12 702.415 2367.2 699.337 2371 699.337L2679.23 699.337 2672.36 706.212 2672.36 642 2686.11 642 2686.11 706.212C2686.11 710.009 2683.03 713.087 2679.23 713.087L2371 713.087 2377.87 706.212 2377.87 736.049ZM2391.62 729.174 2371 770.424 2350.37 729.174Z"/><path d="M22.9165-3.4375 43.5415-3.4375 43.5415 3.4375 22.9165 3.4375ZM50.4165-3.4375 71.0415-3.4375 71.0415 3.4375 50.4165 3.4375ZM77.9165-3.4375 98.5415-3.4375 98.5415 3.4375 77.9165 3.4375ZM105.416-3.4375 126.041-3.4375 126.041 3.4375 105.416 3.4375ZM132.916-3.4375 153.541-3.4375 153.541 3.4375 132.916 3.4375ZM160.416-3.4375 181.041-3.4375 181.041 3.4375 160.416 3.4375ZM187.916-3.4375 208.541-3.4375 208.541 3.4375 187.916 3.4375ZM215.416-3.4375 236.041-3.4375 236.041 3.4375 215.416 3.4375ZM242.916-3.4375 263.541-3.4375 263.541 3.4375 242.916 3.4375ZM269.127 4.72728 269.127 25.3523 262.252 25.3523 262.252 4.72728ZM269.127 32.2273 269.127 52.8523 262.252 52.8523 262.252 32.2273ZM269.127 59.7273 269.127 80.3523 262.252 80.3523 262.252 59.7273ZM269.127 87.2273 269.127 107.852 262.252 107.852 262.252 87.2273ZM269.127 114.727 269.127 135.352 262.252 135.352 262.252 114.727ZM269.127 142.227 269.127 162.852 262.252 162.852 262.252 142.227ZM269.127 169.727 269.127 190.352 262.252 190.352 262.252 169.727ZM269.127 197.227 269.127 217.852 262.252 217.852 262.252 197.227ZM269.127 224.727 269.127 245.352 262.252 245.352 262.252 224.727ZM269.127 252.227 269.127 272.852 262.252 272.852 262.252 252.227ZM269.127 279.727 269.127 300.352 262.252 300.352 262.252 279.727ZM269.127 307.227 269.127 327.852 262.252 327.852 262.252 307.227ZM269.127 334.727 269.127 355.352 262.252 355.352 262.252 334.727ZM269.127 362.227 269.127 382.852 262.252 382.852 262.252 362.227ZM269.127 389.727 269.127 392.955 265.689 389.517 283.087 389.517 283.087 396.392 265.689 396.392C263.791 396.392 262.252 394.853 262.252 392.955L262.252 389.727ZM289.962 389.517 310.587 389.517 310.587 396.392 289.962 396.392ZM317.462 389.517 338.087 389.517 338.087 396.392 317.462 396.392ZM344.962 389.517 365.587 389.517 365.587 396.392 344.962 396.392ZM372.462 389.517 393.087 389.517 393.087 396.392 372.462 396.392ZM399.962 389.517 420.587 389.517 420.587 396.392 399.962 396.392ZM427.462 389.517 448.087 389.517 448.087 396.392 427.462 396.392ZM454.962 389.517 475.587 389.517 475.587 396.392 454.962 396.392ZM27.5 13.75 0 0 27.5-13.75ZM472.743 379.205 500.243 392.955 472.743 406.705Z" transform="matrix(-1 1.22465e-16 1.22465e-16 1 3395.74 1176.5)"/><path d="M22.9166-3.4375 43.5416-3.4375 43.5416 3.4375 22.9166 3.4375ZM50.4166-3.4375 71.0416-3.4375 71.0416 3.4375 50.4166 3.4375ZM77.9166-3.4375 98.5416-3.4375 98.5416 3.4375 77.9166 3.4375ZM105.417-3.4375 126.042-3.4375 126.042 3.4375 105.417 3.4375ZM132.917-3.4375 153.542-3.4375 153.542 3.4375 132.917 3.4375ZM160.417-3.4375 181.042-3.4375 181.042 3.4375 160.417 3.4375ZM187.917-3.4375 208.542-3.4375 208.542 3.4375 187.917 3.4375ZM215.417-3.4375 236.042-3.4375 236.042 3.4375 215.417 3.4375ZM242.917-3.4375 263.542-3.4375 263.542 3.4375 242.917 3.4375ZM270.417-3.4375 291.042-3.4375 291.042 3.4375 270.417 3.4375ZM297.917-3.4375 315.499-3.4375C317.398-3.4375 318.937-1.89848 318.937 0L318.937 3.04239 312.062 3.04239 312.062 0 315.499 3.4375 297.917 3.4375ZM318.937 9.91739 318.937 30.5424 312.062 30.5424 312.062 9.91739ZM318.937 37.4174 318.937 58.0424 312.062 58.0424 312.062 37.4174ZM318.937 64.9174 318.937 85.5424 312.062 85.5424 312.062 64.9174ZM318.937 92.4174 318.937 113.042 312.062 113.042 312.062 92.4174ZM318.937 119.917 318.937 140.542 312.062 140.542 312.062 119.917ZM318.937 147.417 318.937 168.042 312.062 168.042 312.062 147.417ZM318.937 174.917 318.937 195.542 312.062 195.542 312.062 174.917ZM318.937 202.417 318.937 223.042 312.062 223.042 312.062 202.417ZM318.937 229.917 318.937 250.542 312.062 250.542 312.062 229.917ZM318.937 257.417 318.937 278.042 312.062 278.042 312.062 257.417ZM318.937 284.917 318.937 305.542 312.062 305.542 312.062 284.917ZM318.937 312.417 318.937 333.042 312.062 333.042 312.062 312.417ZM318.937 339.917 318.937 349.056 315.499 345.619 326.985 345.619 326.985 352.494 315.499 352.494C313.601 352.494 312.062 350.955 312.062 349.056L312.062 339.917ZM333.86 345.619 354.485 345.619 354.485 352.494 333.86 352.494ZM361.36 345.619 381.985 345.619 381.985 352.494 361.36 352.494ZM388.86 345.619 409.485 345.619 409.485 352.494 388.86 352.494ZM416.36 345.619 436.985 345.619 436.985 352.494 416.36 352.494ZM443.86 345.619 464.485 345.619 464.485 352.494 443.86 352.494ZM471.36 345.619 477.328 345.619 477.328 352.494 471.36 352.494ZM27.5 13.75 0 0 27.5-13.75ZM472.744 335.306 500.244 349.056 472.744 362.806Z" transform="matrix(-1 1.22465e-16 1.22465e-16 1 3395.74 1051.5)"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 3130.26 1160)">same key</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="55" transform="matrix(1 0 0 1 3061.1 1037)">same handle</text><path d="M1630 196 1630 1886.85" stroke="#7F7F7F" stroke-width="10.3125" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="41.25 30.9375" fill="none" fill-rule="evenodd"/><path d="M3033 196 3033 1918.34" stroke="#7F7F7F" stroke-width="10.3125" stroke-linejoin="round" stroke-miterlimit="10" stroke-dasharray="41.25 30.9375" fill="none" fill-rule="evenodd"/><path d="M2672.32 441.625 2672.32 306.331 2679.2 313.206 813.215 313.206 820.09 306.331 820.09 559.124C820.09 562.921 817.012 565.999 813.215 565.999L747 565.999 747 552.249 813.215 552.249 806.34 559.124 806.34 306.331C806.34 302.534 809.418 299.456 813.215 299.456L2679.2 299.456C2682.99 299.456 2686.07 302.534 2686.07 306.331L2686.07 441.625ZM2699.82 434.75 2679.2 476 2658.57 434.75Z"/><path d="M2671.69 441.625 2671.69 306.327 2678.56 313.202 812.885 313.202 819.76 306.327 819.76 762.881C819.76 766.678 816.682 769.756 812.885 769.756L747 769.756 747 756.006 812.885 756.006 806.01 762.881 806.01 306.327C806.01 302.53 809.088 299.452 812.885 299.452L2678.56 299.452C2682.36 299.452 2685.44 302.53 2685.44 306.327L2685.44 441.625ZM2699.19 434.75 2678.56 476 2657.94 434.75Z"/><path d="M1975.14 441.625 1975.14 393.5 1982.02 400.375 1586.88 400.375 1593.75 393.5 1593.75 692.991C1593.75 696.788 1590.67 699.866 1586.88 699.866L1547 699.866 1547 686.116 1586.88 686.116 1580 692.991 1580 393.5C1580 389.703 1583.08 386.625 1586.88 386.625L1982.02 386.625C1985.82 386.625 1988.89 389.703 1988.89 393.5L1988.89 441.625ZM2002.64 434.75 1982.02 476 1961.39 434.75Z"/><path d="M1975.14 441.625 1975.14 393.5 1982.02 400.375 1586.88 400.375 1593.75 393.5 1593.75 896.748C1593.75 900.545 1590.68 903.623 1586.88 903.623L1547 903.623 1547 889.873 1586.88 889.873 1580 896.748 1580 393.5C1580 389.703 1583.08 386.625 1586.88 386.625L1982.02 386.625C1985.82 386.625 1988.89 389.703 1988.89 393.5L1988.89 441.625ZM2002.64 434.75 1982.02 476 1961.39 434.75Z"/><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="55" text-decoration="underline" transform="matrix(1 0 0 1 700.969 243)">Application</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="55" text-decoration="underline" transform="matrix(1 0 0 1 2142.28 246)">Gramine </text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="55" text-decoration="underline" transform="matrix(1 0 0 1 2368.01 246)">LibOS</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="55" text-decoration="underline" transform="matrix(1 0 0 1 3282.66 251)">Gramine Encrypted Files</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="46" transform="matrix(1 0 0 1 122.489 1780)">Glossary:</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="46" transform="matrix(1 0 0 1 122.489 1835)">•</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="46" transform="matrix(1 0 0 1 184.364 1835)">KDK = Key Derivation Key</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="46" transform="matrix(1 0 0 1 122.489 1890)">•</text><text font-family="Arial,Arial_MSFontService,sans-serif" font-weight="400" font-size="46" transform="matrix(1 0 0 1 184.364 1890)">MHT = Merkle Hash Tree</text></g></svg>